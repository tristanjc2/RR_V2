{"ast":null,"code":"import _objectSpread from\"C:/RR_V3/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import{fetchReviews,addReview,deleteReview}from\"../firebaseReviews\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReviewSection=_ref=>{let{isAdmin,productList=[]}=_ref;const[form,setForm]=useState({name:\"\",rating:5,text:\"\",productId:\"general\"});const[reviews,setReviews]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");useEffect(()=>{const load=async()=>{setLoading(true);try{const data=await fetchReviews();setReviews(data);}catch(err){setError(\"Failed to load reviews.\");}setLoading(false);};load();},[]);const handleChange=e=>{setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();try{await addReview(form);// Reload reviews\nconst data=await fetchReviews();setReviews(data);setForm({name:\"\",rating:5,text:\"\",productId:\"general\"});}catch(err){setError(\"Failed to submit review.\");}};const handleDelete=async id=>{try{await deleteReview(id);setReviews(reviews.filter(r=>r.id!==id));}catch(err){setError(\"Failed to delete review.\");}};return/*#__PURE__*/_jsxs(\"div\",{id:\"reviews\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold mb-4\",children:\"Customer Reviews\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"mb-6 space-y-3\",children:[/*#__PURE__*/_jsxs(\"select\",{name:\"productId\",value:form.productId,onChange:handleChange,className:\"border px-3 py-2 rounded w-full\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"general\",children:\"General Company Review\"}),(()=>{const groups=[];const grouped={};productList.forEach(p=>{if(!grouped[p.category])grouped[p.category]={};if(!grouped[p.category][p.subcategory])grouped[p.category][p.subcategory]=[];grouped[p.category][p.subcategory].push(p);});Object.entries(grouped).forEach(_ref2=>{let[cat,subs]=_ref2;groups.push(/*#__PURE__*/_jsx(\"optgroup\",{label:cat,children:Object.entries(subs).flatMap(_ref3=>{let[sub,prods]=_ref3;return prods.map(prod=>/*#__PURE__*/_jsxs(\"option\",{value:prod.id,children:[sub,\": \",prod.name]},prod.id));})},cat));});return groups;})()]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:form.name,onChange:handleChange,placeholder:\"Your name\",className:\"border px-3 py-2 rounded w-full\",required:true}),/*#__PURE__*/_jsx(\"select\",{name:\"rating\",value:form.rating,onChange:handleChange,className:\"border px-3 py-2 rounded w-full\",children:[5,4,3,2,1].map(r=>/*#__PURE__*/_jsxs(\"option\",{value:r,children:[r,\" Star\",r>1?'s':'']},r))}),/*#__PURE__*/_jsx(\"textarea\",{name:\"text\",value:form.text,onChange:handleChange,placeholder:\"Write your review...\",className:\"border px-3 py-2 rounded w-full\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 transition\",children:\"Submit Review\"})]}),loading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading reviews...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-600\",children:error}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-4\",children:reviews.map(r=>{var _productList$find;const productName=r.productId&&r.productId!==\"general\"?((_productList$find=productList.find(p=>String(p.id)===String(r.productId)))===null||_productList$find===void 0?void 0:_productList$find.name)||\"[Deleted Product]\":null;return/*#__PURE__*/_jsxs(\"li\",{className:\"border rounded p-4 bg-gray-50 relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold mr-2\",children:r.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-yellow-500\",children:['\\u2605'.repeat(r.rating),'\\u2606'.repeat(5-r.rating)]}),productName?/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded\",children:productName}):/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs bg-gray-100 text-gray-700 px-2 py-0.5 rounded\",children:\"General\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 italic\",children:[\"\\u201C\",r.text,\"\\u201D\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400\",children:new Date(r.date).toLocaleDateString()}),isAdmin&&/*#__PURE__*/_jsx(\"button\",{className:\"absolute top-2 right-2 bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700\",onClick:()=>handleDelete(r.id),children:\"Delete\"})]},r.id);})})]});};export default ReviewSection;","map":{"version":3,"names":["React","useEffect","useState","fetchReviews","addReview","deleteReview","jsx","_jsx","jsxs","_jsxs","ReviewSection","_ref","isAdmin","productList","form","setForm","name","rating","text","productId","reviews","setReviews","loading","setLoading","error","setError","load","data","err","handleChange","e","_objectSpread","target","value","handleSubmit","preventDefault","handleDelete","id","filter","r","children","className","onSubmit","onChange","groups","grouped","forEach","p","category","subcategory","push","Object","entries","_ref2","cat","subs","label","flatMap","_ref3","sub","prods","map","prod","type","placeholder","required","_productList$find","productName","find","String","repeat","Date","date","toLocaleDateString","onClick"],"sources":["C:/RR_V3/src/components/ReviewSection.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { fetchReviews, addReview, deleteReview } from \"../firebaseReviews\";\n\nconst ReviewSection = ({ isAdmin, productList = [] }) => {\n  const [form, setForm] = useState({ name: \"\", rating: 5, text: \"\", productId: \"general\" });\n  const [reviews, setReviews] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    const load = async () => {\n      setLoading(true);\n      try {\n        const data = await fetchReviews();\n        setReviews(data);\n      } catch (err) {\n        setError(\"Failed to load reviews.\");\n      }\n      setLoading(false);\n    };\n    load();\n  }, []);\n\n  const handleChange = (e) => {\n    setForm({ ...form, [e.target.name]: e.target.value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      await addReview(form);\n      // Reload reviews\n      const data = await fetchReviews();\n      setReviews(data);\n      setForm({ name: \"\", rating: 5, text: \"\", productId: \"general\" });\n    } catch (err) {\n      setError(\"Failed to submit review.\");\n    }\n  };\n\n  const handleDelete = async (id) => {\n    try {\n      await deleteReview(id);\n      setReviews(reviews.filter(r => r.id !== id));\n    } catch (err) {\n      setError(\"Failed to delete review.\");\n    }\n  };\n\n  return (\n    <div id=\"reviews\">\n      <h3 className=\"text-2xl font-bold mb-4\">Customer Reviews</h3>\n      <form onSubmit={handleSubmit} className=\"mb-6 space-y-3\">\n        <select\n          name=\"productId\"\n          value={form.productId}\n          onChange={handleChange}\n          className=\"border px-3 py-2 rounded w-full\"\n        >\n          <option value=\"general\">General Company Review</option>\n          {/* Group products by category and subcategory */}\n          {(() => {\n  const groups = [];\n  const grouped = {};\n  productList.forEach(p => {\n    if (!grouped[p.category]) grouped[p.category] = {};\n    if (!grouped[p.category][p.subcategory]) grouped[p.category][p.subcategory] = [];\n    grouped[p.category][p.subcategory].push(p);\n  });\n  Object.entries(grouped).forEach(([cat, subs]) => {\n    groups.push(\n      <optgroup key={cat} label={cat}>\n        {Object.entries(subs).flatMap(([sub, prods]) =>\n          prods.map(prod => (\n            <option key={prod.id} value={prod.id}>{sub}: {prod.name}</option>\n          ))\n        )}\n      </optgroup>\n    );\n  });\n  return groups;\n})()}\n\n        </select>\n        <input\n          type=\"text\"\n          name=\"name\"\n          value={form.name}\n          onChange={handleChange}\n          placeholder=\"Your name\"\n          className=\"border px-3 py-2 rounded w-full\"\n          required\n        />\n        <select\n          name=\"rating\"\n          value={form.rating}\n          onChange={handleChange}\n          className=\"border px-3 py-2 rounded w-full\"\n        >\n          {[5, 4, 3, 2, 1].map((r) => (\n            <option key={r} value={r}>{r} Star{r > 1 ? 's' : ''}</option>\n          ))}\n        </select>\n        <textarea\n          name=\"text\"\n          value={form.text}\n          onChange={handleChange}\n          placeholder=\"Write your review...\"\n          className=\"border px-3 py-2 rounded w-full\"\n          required\n        />\n        <button\n          type=\"submit\"\n          className=\"bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 transition\"\n        >\n          Submit Review\n        </button>\n      </form>\n      {loading && <div>Loading reviews...</div>}\n      {error && <div className=\"text-red-600\">{error}</div>}\n      <ul className=\"space-y-4\">\n        {reviews.map((r) => {\n          const productName = r.productId && r.productId !== \"general\"\n            ? (productList.find(p => String(p.id) === String(r.productId))?.name || \"[Deleted Product]\")\n            : null;\n          return (\n            <li key={r.id} className=\"border rounded p-4 bg-gray-50 relative\">\n              <div className=\"flex items-center mb-1\">\n                <span className=\"font-semibold mr-2\">{r.name}</span>\n                <span className=\"text-yellow-500\">{'\\u2605'.repeat(r.rating)}{'\\u2606'.repeat(5 - r.rating)}</span>\n                {productName ? (\n                  <span className=\"ml-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded\">{productName}</span>\n                ) : (\n                  <span className=\"ml-2 text-xs bg-gray-100 text-gray-700 px-2 py-0.5 rounded\">General</span>\n                )}\n              </div>\n              <p className=\"text-gray-700 italic\">“{r.text}”</p>\n              <span className=\"text-xs text-gray-400\">{new Date(r.date).toLocaleDateString()}</span>\n              {isAdmin && (\n                <button className=\"absolute top-2 right-2 bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700\" onClick={() => handleDelete(r.id)}>Delete</button>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n};\n\nexport default ReviewSection;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}